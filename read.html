<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Read Data</title>
</head>

<body>
    <form id="readForm">
        <input type="text" id="username" placeholder="Enter Name to Read" required><br>
        <input type="submit" value="Read Data">
    </form>
    <p id="output"></p>
    <script type="module">
        // Import Firebase functions - fixed imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getDatabase, ref, get, child } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBlfnZvS9N2XBjBMiKMnlCywc-FjBnkDhQ",
            authDomain: "plnat-growth.firebaseapp.com",
            databaseURL: "https://plnat-growth-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "plnat-growth",
            storageBucket: "plnat-growth.firebasestorage.app",
            messagingSenderId: "714741844786",
            appId: "1:714741844786:web:ce7246947c8d5a109f252b",
            measurementId: "G-PLPRSHRBH7"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // Add an event listener to the form
        document.getElementById("readForm").addEventListener("submit", function (e) {
            e.preventDefault();

            const username = document.getElementById("username").value;
            const outputElement = document.getElementById("output");

            // Clear previous output
            outputElement.innerText = "Loading...";

            // Reference the data and get it
            const dbRef = ref(db);

            // Updated path to "users/" instead of "user/" to match write form
            get(child(dbRef, `users/${username}`))
                .then((snapshot) => {
                    if (snapshot.exists()) {
                        const data = snapshot.val();
                        outputElement.innerText = `Name: ${data.username}\nEmail: ${data.email}\nPhone: ${data.phone}`;
                    } else {
                        outputElement.innerText = "No data found for this username";
                    }
                })
                .catch((error) => {
                    console.error("Error reading data:", error);
                    outputElement.innerText = `Error: ${error.message}`;
                });
        });
    </script>
</body>

</html>